---->>>>The article I used to find the keywords of buffer overflow
      https://snyk.io/blog/buffer-overflow-attacks-in-c/




---->>>I updated this function so that it detect buffer overflow, replace in your code to run it

void StaticCodeAnalyzer::analyzeCode()
{
    if (currentFileContent.isEmpty()) {
        QMessageBox::warning(this, "Error", "No file loaded");
        return;
    }

    // Unsafe patterns
    QRegularExpression unsafePatterns[] = {
        QRegularExpression("\\bstrcpy\\s*\\("),
        QRegularExpression("\\bstrcat\\s*\\("),
        QRegularExpression("\\bstrcmp\\s*\\("),
        QRegularExpression("\\bstrncat\\s*\\(\\s*[^,]*,[^,]*\\s*,\\s*[^,]*\\s*\\)"), // unsafe usage
        QRegularExpression("\\bscanf\\s*\\("),
        QRegularExpression("\\bfscanf\\s*\\("),
        QRegularExpression("\\bsscanf\\s*\\("),
        QRegularExpression("\\bgets\\s*\\("),
        QRegularExpression("char\\s*\\*"),
        QRegularExpression("\\bchar\\s+\\w+\\s*\\[\\d+\\]"),
        QRegularExpression("\\breinterpret_cast\\s*\\("),
        QRegularExpression("\\bstrtok\\s*\\("),
        QRegularExpression("\\bsprintf\\s*\\("),
        QRegularExpression("\\bchar\\s*\\*"),
        QRegularExpression("\\bint\\s+\\w+\\s*\\[15\\]"),
        QRegularExpression("std::cin"),
        QRegularExpression("<cstdio>"),
        QRegularExpression("<cstring>")
    };

    QStringList foundPatterns;

    // Check for unsafe patterns
    for (const auto& pattern : unsafePatterns) {
        if (currentFileContent.contains(pattern)) {
            foundPatterns.append(pattern.pattern());
        }
    }

    // Display results
    if (!foundPatterns.isEmpty()) {
        QString result = "Unsafe Patterns Found:\n" + foundPatterns.join("\n");
        ui->labelResult->setText(result);
    } else {
        ui->labelResult->setText("No unsafe patterns found.");
    }
}













---->>>unsafe words that cause buffer overflow 

//////////////////////////////////////////////////////////////////////////////////////////////////// 

Not Safe APIs 

C-style String Functions: 

strcpy 

strcat 

strcmp 

strncat (if improperly used with incorrect size) 

C-style Input Functions: 

scanf 

fscanf 

sscanf 

gets (deprecated but commonly used) 

Unsafe Memory Operations: 

Raw pointers (e.g., char*) 

Fixed-size arrays (e.g., char input[8]) 

reinterpret_cast (can lead to unsafe conversions) 

Legacy Functions: 

gets 

strtok 

sprintf (can overflow if not properly handled) 

Keywords to Avoid 

char* 

int array[15] 

scanf 

fscanf 

sscanf 

strcpy 

strcat 

std::cin 

<cstdio> 

<cstring> 

strncat (if used incorrectly) 

reinterpret_cast (potentially unsafe conversions) 

sprintf (risk of overflow) 

 

Not Safe APIs 

C-style String Functions: 

strncat (if improperly used with incorrect size) 

C-style Input Functions: 

gets (deprecated but commonly used) 

Unsafe Memory Operations: 

reinterpret_cast (can lead to unsafe conversions) 

Legacy Functions: 

sprintf (can overflow if not properly handled) 




----->>> A buffer overflow occurs when a program writes more data to a buffer than it can hold, causing adjacent memory to be overwritten. This can lead to crashes, unexpected behavior, or allow attackers to execute malicious code.

////how buffer overflow occurs

how an attacker could breach a student’s code using a buffer overflow:

Finding a Vulnerable Program: The attacker looks for a program (like the student’s code) that doesn’t properly check how much data it receives. For example, if the program accepts user input without limits, it might be vulnerable.

Sending Overlarge Input: The attacker sends a carefully crafted input that exceeds the buffer’s size. For instance, if the program allows a user to enter their name into a fixed-size array but doesn’t check the length, the attacker might input a name that’s much longer than expected.

Overwriting Memory: As this long input is processed, it spills over into adjacent memory locations. This can overwrite important data, like the program's return address (where the program should go next after executing a function).

Injecting Malicious Code: The attacker can include malicious code in the input. When the buffer overflows, the attacker’s code can be placed in memory where the program will execute it.

Taking Control: When the program tries to return from the function, it looks at the overwritten return address and instead goes to the location where the attacker’s code is stored, running that code instead of what was intended.

Performing Malicious Actions: Now, the attacker can execute whatever commands they designed in their malicious code, potentially stealing data, corrupting files, or taking control of the system.
